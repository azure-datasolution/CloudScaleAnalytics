10|2010-01-15 11:01:02.223|dbo|Event|Schema|DimProduct|CREATE TABLE [dbo].[DimProduct] ([ProductKey] [int] IDENTITY(1,1) NOT NULL,[ProductAlternateKey] [nvarchar] (25) NULL,[ProductSubcategoryKey] [int] NULL,[WeightUnitMeasureCode] [nchar] (3) NULL,[SizeUnitMeasureCode] [nchar] (3) NULL,[EnglishProductName] [nvarchar] (50) NOT NULL,[SpanishProductName] [nvarchar] (50) NOT NULL,[FrenchProductName] [nvarchar] (50) NOT NULL,[StandardCost] [money] NULL,[FinishedGoodsFlag] [bit] NOT NULL,[Color] [nvarchar] (15) NOT NULL,[SafetyStockLevel] [smallint] NULL,[ReorderPoint] [smallint] NULL,[ListPrice] [money] NULL,[Size] [nvarchar] (50) NULL,[SizeRange] [nvarchar] (50) NULL,[Weight] [float] NULL,[DaysToManufacture] [int] NULL,[ProductLine] [nchar] (2) NULL,[DealerPrice] [money] NULL,[Class] [nchar] (2) NULL,[Style] [nchar] (2) NULL,[ModelName] [nvarchar] (50) NULL,[LargePhoto] [varbinary] (max) NULL,[EnglishDescription] [nvarchar] (400) NULL,[FrenchDescription] [nvarchar] (400) COLLATE French_CI_AS NULL, [ChineseDescription] [nvarchar] (400) COLLATE Chinese_PRC_CI_AI NULL, [ArabicDescription] [nvarchar] (400) COLLATE Arabic_CI_AS NULL, [HebrewDescription] [nvarchar] (400) COLLATE Hebrew_CI_AS NULL, [ThaiDescription] [nvarchar] (400) COLLATE Thai_CI_AS NULL, [GermanDescription] [nvarchar] (400) COLLATE Latin1_General_100_CI_AS NULL,[JapaneseDescription] [nvarchar] (400) COLLATE Japanese_CI_AS NULL,[TurkishDescription] [nvarchar] (400) COLLATE Turkish_CI_AS NULL,[StartDate] [datetime] NULL,[EndDate] [datetime] NULL,[Status] [nvarchar] (7) NULL) ON [PRIMARY];
1|2010-01-15 11:01:02.190|dbo|Event|Schema|AdventureWorksDWBuildVersion|CREATE TABLE [dbo].[AdventureWorksDWBuildVersion] ([DBVersion] [nvarchar] (50) NULL,[VersionDate] [datetime] NULL ) ON [PRIMARY];
86|2010-01-15 11:01:10.830|dbo|Event|Schema|IX_FactSurveyResponse_ProductSubcategoryKey|CREATE INDEX [IX_FactSurveyResponse_ProductSubcategoryKey] ON [dbo].[FactSurveyResponse] ([ProductSubcategoryKey]) ON [PRIMARY];
106|2010-01-15 11:01:11.910|dbo|Event|Schema|udfTwoDigitZeroFill|CREATE FUNCTION [dbo].[udfTwoDigitZeroFill] (@number int) RETURNS char(2)ASBEGINDECLARE @result char(2);IF @number > 9 SET @result = convert(char(2), @number);ELSESET @result = convert(char(2), '0' + convert(varchar, @number));RETURN @result;END
85|2010-01-15 11:01:10.830|dbo|Event|Schema|IX_FactSurveyResponse_CustomerKey|CREATE INDEX [IX_FactSurveyResponse_CustomerKey] ON [dbo].[FactSurveyResponse] ([CustomerKey]) ON [PRIMARY];
46|2010-01-15 11:01:08.667|dbo|Event|Schema|FactResellerSales|ALTER TABLE [dbo].[FactResellerSales] ADD CONSTRAINT [PK_FactResellerSales_SalesOrderNumber_SalesOrderLineNumber] PRIMARY KEY CLUSTERED ([SalesOrderNumber],[SalesOrderLineNumber])  ON [PRIMARY];
15|2010-01-15 11:01:02.223|dbo|Event|Schema|DimSalesReason|CREATE TABLE [dbo].[DimSalesReason] ([SalesReasonKey] [int] IDENTITY(1, 1) NOT NULL,[SalesReasonAlternateKey] [int] NOT NULL,[SalesReasonName] [nvarchar] (50) NOT NULL,[SalesReasonReasonType] [nvarchar] (50) NOT NULL ) ON [PRIMARY];
79|2010-01-15 11:01:10.567|dbo|Event|Schema|IX_FactResellerSales_ShipDateKey|CREATE INDEX [IX_FactResellerSales_ShipDateKey] ON [dbo].[FactResellerSales]([ShipDateKey]) ON [PRIMARY];
110|2010-01-15 11:01:12.020|dbo|Event|Schema|vTargetMail|CREATE VIEW [dbo].[vTargetMail] ASSELECTc.[CustomerKey], c.[GeographyKey], c.[CustomerAlternateKey], c.[Title], c.[FirstName], c.[MiddleName], c.[LastName], c.[NameStyle], c.[BirthDate], c.[MaritalStatus], c.[Suffix], c.[Gender], c.[EmailAddress], c.[YearlyIncome], c.[TotalChildren], c.[NumberChildrenAtHome], c.[EnglishEducation], c.[SpanishEducation], c.[FrenchEducation], c.[EnglishOccupation], c.[SpanishOccupation], c.[FrenchOccupation], c.[HouseOwnerFlag], c.[NumberCarsOwned], c.[AddressLine1], c.[AddressLine2], c.[Phone], c.[DateFirstPurchase], c.[CommuteDistance], x.[Region], x.[Age], CASE x.[Bikes] WHEN 0 THEN 0 ELSE 1 END AS [BikeBuyer]FROM[dbo].[DimCustomer] c INNER JOIN (SELECT[CustomerKey],[Region],[Age],Sum(CASE [EnglishProductCategoryName] WHEN 'Bikes' THEN 1 ELSE 0 END) AS [Bikes]FROM[dbo].[vDMPrep] GROUP BY[CustomerKey],[Region],[Age]) AS [x]ON c.[CustomerKey] = x.[CustomerKey];
17|2010-01-15 11:01:02.240|dbo|Event|Schema|DimScenario|CREATE TABLE [dbo].[DimScenario] ([ScenarioKey] [int] IDENTITY(1, 1) NOT NULL,[ScenarioName] [nvarchar] (50) NULL ) ON [PRIMARY];
39|2010-01-15 11:01:08.137|dbo|Event|Schema|DimSalesReason|ALTER TABLE [dbo].[DimSalesReason] WITH CHECK ADD CONSTRAINT [PK_DimSalesReason_SalesReasonKey] PRIMARY KEY CLUSTERED ([SalesReasonKey])  ON [PRIMARY];
75|2010-01-15 11:01:09.993|dbo|Event|Schema|IX_FactResellerSales_DueDateKey|CREATE INDEX [IX_FactResellerSales_DueDateKey] ON [dbo].[FactResellerSales]([DueDateKey]) ON [PRIMARY];
84|2010-01-15 11:01:10.830|dbo|Event|Schema|IX_FactSurveyResponse_DateKey|CREATE INDEX [IX_FactSurveyResponse_DateKey] ON [dbo].[FactSurveyResponse] ([DateKey]) ON [PRIMARY];
5|2010-01-15 11:01:02.207|dbo|Event|Schema|DimDate|CREATE TABLE [dbo].[DimDate] ([DateKey] int NOT NULL,[FullDateAlternateKey] [date] NOT NULL,[DayNumberOfWeek] [tinyint] NOT NULL,[EnglishDayNameOfWeek] [nvarchar] (10) NOT NULL,[SpanishDayNameOfWeek] [nvarchar] (10) NOT NULL,[FrenchDayNameOfWeek] [nvarchar] (10) NOT NULL,[DayNumberOfMonth] [tinyint] NOT NULL,[DayNumberOfYear] [smallint] NOT NULL,[WeekNumberOfYear] [tinyint] NOT NULL,[EnglishMonthName] [nvarchar] (10) NOT NULL,[SpanishMonthName] [nvarchar] (10) NOT NULL,[FrenchMonthName] [nvarchar] (10) NOT NULL,[MonthNumberOfYear] [tinyint] NOT NULL,[CalendarQuarter] [tinyint] NOT NULL,[CalendarYear] [smallint] NOT NULL,[CalendarSemester] [tinyint] NOT NULL,[FiscalQuarter] [tinyint] NOT NULL,[FiscalYear] [smallint] NOT NULL,[FiscalSemester] [tinyint] NOT NULL ) ON [PRIMARY];
2|2010-01-15 11:01:02.190|dbo|Event|Schema|DimAccount|CREATE TABLE [dbo].[DimAccount] ([AccountKey] [int] IDENTITY(1, 1) NOT NULL,[ParentAccountKey] [int] NULL,[AccountCodeAlternateKey] [int] NULL,[ParentAccountCodeAlternateKey] [int] NULL,[AccountDescription] [nvarchar] (50) NULL,[AccountType] [nvarchar] (50) NULL,[Operator] [nvarchar] (50) NULL,[CustomMembers] [nvarchar] (300) NULL,[ValueType] [nvarchar] (50) NULL,[CustomMemberOptions] [nvarchar] (200) NULL ) ON [PRIMARY];
61|2010-01-15 11:01:08.947|dbo|Event|Schema|DimPromotion|ALTER TABLE [dbo].[DimPromotion] ADD CONSTRAINT [AK_DimPromotion_PromotionAlternateKey] UNIQUE NONCLUSTERED ([PromotionAlternateKey])  ON [PRIMARY];
60|2010-01-15 11:01:08.947|dbo|Event|Schema|DimProductSubcategory|ALTER TABLE [dbo].[DimProductSubcategory] ADD CONSTRAINT [AK_DimProductSubcategory_ProductSubcategoryAlternateKey] UNIQUE NONCLUSTERED ([ProductSubcategoryAlternateKey])  ON [PRIMARY];
32|2010-01-15 11:01:08.090|dbo|Event|Schema|DimGeography|ALTER TABLE [dbo].[DimGeography] WITH CHECK ADD CONSTRAINT [PK_DimGeography_GeographyKey] PRIMARY KEY CLUSTERED ([GeographyKey])  ON [PRIMARY];
63|2010-01-15 11:01:08.947|dbo|Event|Schema|IX_DimReseller_GeographyKey|CREATE INDEX [IX_DimReseller_GeographyKey] ON [dbo].[DimReseller]([GeographyKey]) ON [PRIMARY];
20|2010-01-15 11:01:02.240|dbo|Event|Schema|FactFinance|CREATE TABLE [dbo].[FactFinance] ([FinanceKey] [int] IDENTITY(1, 1) NOT NULL,[DateKey] [int] NOT NULL,[OrganizationKey] [int] NOT NULL,[DepartmentGroupKey] [int] NOT NULL,[ScenarioKey] [int] NOT NULL,[AccountKey] [int] NOT NULL,[Amount] [float] NOT NULL ) ON [PRIMARY];
58|2010-01-15 11:01:08.930|dbo|Event|Schema|IX_DimProduct_ProductSubcategoryKey|CREATE INDEX [IX_DimProduct_ProductSubcategoryKey] ON [dbo].[DimProduct]([ProductSubcategoryKey]) ON [PRIMARY];
52|2010-01-15 11:01:08.853|dbo|Event|Schema|DimCurrency|ALTER TABLE [dbo].[DimCurrency] ADD CONSTRAINT [AK_DimCurrency_CurrencyAlternateKey] UNIQUE NONCLUSTERED ([CurrencyAlternateKey])  ON [PRIMARY];
14|2010-01-15 11:01:02.223|dbo|Event|Schema|DimReseller|CREATE TABLE [dbo].[DimReseller] ([ResellerKey] [int] IDENTITY(1, 1) NOT NULL,[GeographyKey] [int] NULL,[ResellerAlternateKey] [nvarchar] (15) NULL,[Phone] [nvarchar] (25) NULL,[BusinessType] [varchar] (20) NOT NULL,[ResellerName] [nvarchar] (50) NOT NULL,[NumberEmployees] [int] NULL,[OrderFrequency] [char] (1) NULL,[OrderMonth] [tinyint] NULL,[FirstOrderYear] [int] NULL,[LastOrderYear] [int] NULL,[ProductLine] [nvarchar] (50) NULL,[AddressLine1] [nvarchar] (60) NULL,[AddressLine2] [nvarchar] (60) NULL,[AnnualSales] [money] NULL,[BankName] [nvarchar] (50) NULL,[MinPaymentType] [tinyint] NULL,[MinPaymentAmount] [money] NULL,[AnnualRevenue] [money] NULL,[YearOpened] [int] NULL ) ON [PRIMARY];
41|2010-01-15 11:01:08.150|dbo|Event|Schema|DimScenario|ALTER TABLE [dbo].[DimScenario] WITH CHECK ADD CONSTRAINT [PK_DimScenario] PRIMARY KEY CLUSTERED ([ScenarioKey])  ON [PRIMARY];
82|2010-01-15 11:01:10.817|dbo|Event|Schema|IX_FactSalesQuota_EmployeeKey|CREATE INDEX [IX_FactSalesQuota_EmployeeKey] ON [dbo].[FactSalesQuota]([EmployeeKey]) ON [PRIMARY];
78|2010-01-15 11:01:10.440|dbo|Event|Schema|IX_FactResellerSales_PromotionKey|CREATE INDEX [IX_FactResellerSales_PromotionKey] ON [dbo].[FactResellerSales]([PromotionKey]) ON [PRIMARY];
28|2010-01-15 11:01:07.940|dbo|Event|Schema|DimCurrency|ALTER TABLE [dbo].[DimCurrency] WITH CHECK ADD CONSTRAINT [PK_DimCurrency_CurrencyKey] PRIMARY KEY CLUSTERED ([CurrencyKey])  ON [PRIMARY];
88|2010-01-15 11:01:10.860|dbo|Event|Schema|DimAccount|ALTER TABLE [dbo].[DimAccount] ADD CONSTRAINT [FK_DimAccount_DimAccount] FOREIGN KEY ([ParentAccountKey]) REFERENCES [dbo].[DimAccount] ([AccountKey]);
97|2010-01-15 11:01:10.910|dbo|Event|Schema|FactCallCenter|ALTER TABLE [dbo].[FactCallCenter] ADDCONSTRAINT [FK_FactCallCenter_DimDate] FOREIGN KEY([DateKey]) REFERENCES [dbo].[DimDate] ([DateKey]);
69|2010-01-15 11:01:09.290|dbo|Event|Schema|IX_FactInternetSales_DueDateKey|CREATE INDEX [IX_FactInternetSales_DueDateKey] ON [dbo].[FactInternetSales]([DueDateKey]) ON [PRIMARY];
83|2010-01-15 11:01:10.817|dbo|Event|Schema|IX_FactSalesQuota_DateKey|CREATE INDEX [IX_FactSalesQuota_DateKey] ON [dbo].[FactSalesQuota]([DateKey]) ON [PRIMARY];
31|2010-01-15 11:01:08.057|dbo|Event|Schema|DimEmployee|ALTER TABLE [dbo].[DimEmployee] WITH CHECK ADD CONSTRAINT [PK_DimEmployee_EmployeeKey] PRIMARY KEY CLUSTERED ([EmployeeKey])  ON [PRIMARY];
44|2010-01-15 11:01:08.183|dbo|Event|Schema|FactCurrencyRate|ALTER TABLE [dbo].[FactCurrencyRate] WITH CHECK ADDCONSTRAINT [PK_FactCurrencyRate_CurrencyKey_DateKey] PRIMARY KEY CLUSTERED([CurrencyKey],[DateKey]) ON [PRIMARY];
24|2010-01-15 11:01:02.567|dbo|Event|Schema|FactSalesQuota|CREATE TABLE [dbo].[FactSalesQuota] ([SalesQuotaKey] [int] IDENTITY(1, 1) NOT NULL,[EmployeeKey] [int] NOT NULL,[DateKey] [int] NOT NULL,[CalendarYear] [smallint] NOT NULL,[CalendarQuarter] [tinyint] NOT NULL,[SalesAmountQuota] [money] NOT NULL ) ON [PRIMARY];
13|2010-01-15 11:01:02.223|dbo|Event|Schema|DimPromotion|CREATE TABLE [dbo].[DimPromotion] ([PromotionKey] [int] IDENTITY(1, 1) NOT NULL,[PromotionAlternateKey] [int] NULL,[EnglishPromotionName] [nvarchar] (255) NULL,[SpanishPromotionName] [nvarchar] (255) NULL,[FrenchPromotionName] [nvarchar] (255) NULL,[DiscountPct] [float] NULL,[EnglishPromotionType] [nvarchar] (50) NULL,[SpanishPromotionType] [nvarchar] (50) NULL,[FrenchPromotionType] [nvarchar] (50) NULL,[EnglishPromotionCategory] [nvarchar] (50) NULL,[SpanishPromotionCategory] [nvarchar] (50) NULL,[FrenchPromotionCategory] [nvarchar] (50) NULL,[StartDate] [datetime] NOT NULL,[EndDate] [datetime] NULL,[MinQty] [int] NULL,[MaxQty] [int] NULL ) ON [PRIMARY];
50|2010-01-15 11:01:08.837|dbo|Event|Schema|ProspectiveBuyer|ALTER TABLE [dbo].[ProspectiveBuyer] ADDCONSTRAINT [PK_ProspectiveBuyer_ProspectiveBuyerKey] PRIMARY KEY CLUSTERED([ProspectiveBuyerKey]) ON [PRIMARY];
81|2010-01-15 11:01:10.817|dbo|Event|Schema|IX_FactResellerSales_ResellerKey|CREATE INDEX [IX_FactResellerSales_ResellerKey] ON [dbo].[FactResellerSales]([ResellerKey]) ON [PRIMARY];
55|2010-01-15 11:01:08.917|dbo|Event|Schema|IX_DimEmployee_ParentEmployeeKey|CREATE INDEX [IX_DimEmployee_ParentEmployeeKey] ON [dbo].[DimEmployee]([ParentEmployeeKey]) ON [PRIMARY];
7|2010-01-15 11:01:02.207|dbo|Event|Schema|DimEmployee|CREATE TABLE [dbo].[DimEmployee] ([EmployeeKey] [int] IDENTITY(1, 1) NOT NULL,[ParentEmployeeKey] [int] NULL,[EmployeeNationalIDAlternateKey] [nvarchar] (15) NULL,[ParentEmployeeNationalIDAlternateKey] [nvarchar] (15) NULL,[SalesTerritoryKey] [int] NULL,[FirstName] [nvarchar] (50) NOT NULL,[LastName] [nvarchar] (50) NOT NULL,[MiddleName] [nvarchar] (50) NULL,[NameStyle] [bit] NOT NULL,[Title] [nvarchar] (50) NULL,[HireDate] [date] NULL,[BirthDate] [date] NULL,[LoginID] [nvarchar] (256) NULL,[EmailAddress] [nvarchar] (50) NULL,[Phone] [nvarchar] (25) NULL,[MaritalStatus] [nchar] (1) NULL,[EmergencyContactName] [nvarchar] (50) NULL,[EmergencyContactPhone] [nvarchar] (25) NULL,[SalariedFlag] [bit] NULL,[Gender] [nchar] (1) NULL,[PayFrequency] [tinyint] NULL,[BaseRate] [money] NULL,[VacationHours] [smallint] NULL,[SickLeaveHours] [smallint] NULL,[CurrentFlag] [bit] NOT NULL,[SalesPersonFlag] [bit] NOT NULL,[DepartmentName] [nvarchar] (50) NULL,[StartDate] [date] NULL,[EndDate] [date] NULL,[Status] [nvarchar] (50)) ON [PRIMARY];
9|2010-01-15 11:01:02.223|dbo|Event|Schema|DimOrganization|CREATE TABLE [dbo].[DimOrganization] ([OrganizationKey] [int] IDENTITY(1, 1) NOT NULL,[ParentOrganizationKey] [int] NULL,[PercentageOfOwnership] [nvarchar] (16) NULL,[OrganizationName] [nvarchar] (50) NULL,[CurrencyKey] [int]  NULL ) ON [PRIMARY];
8|2010-01-15 11:01:02.207|dbo|Event|Schema|DimGeography|CREATE TABLE [dbo].[DimGeography] ([GeographyKey] [int] IDENTITY(1, 1) NOT NULL,[City] [nvarchar] (30) NULL,[StateProvinceCode] [nvarchar] (3) NULL,[StateProvinceName] [nvarchar] (50) NULL,[CountryRegionCode] [nvarchar] (3) NULL,[EnglishCountryRegionName] [nvarchar] (50) NULL,[SpanishCountryRegionName] [nvarchar] (50) NULL,[FrenchCountryRegionName] [nvarchar] (50) NULL,[PostalCode] [nvarchar] (15) NULL,[SalesTerritoryKey] [int] NULL ) ON [PRIMARY];
59|2010-01-15 11:01:08.930|dbo|Event|Schema|DimProductCategory|ALTER TABLE [dbo].[DimProductCategory] ADD CONSTRAINT [AK_DimProductCategory_ProductCategoryAlternateKey] UNIQUE NONCLUSTERED ([ProductCategoryAlternateKey])  ON [PRIMARY];
54|2010-01-15 11:01:08.917|dbo|Event|Schema|IX_DimCustomer_GeographyKey|CREATE INDEX [IX_DimCustomer_GeographyKey] ON [dbo].[DimCustomer]([GeographyKey]) ON [PRIMARY];
3|2010-01-15 11:01:02.190|dbo|Event|Schema|DimCurrency|CREATE TABLE [dbo].[DimCurrency] ([CurrencyKey] [int] IDENTITY(1, 1) NOT NULL,[CurrencyAlternateKey] [nchar] (3) NOT NULL,[CurrencyName] [nvarchar] (50) NOT NULL ) ON [PRIMARY];
51|2010-01-15 11:01:08.837|dbo|Event|Schema|AK_DimAccount_AccountCodeAlternateKey|CREATE UNIQUE INDEX [AK_DimAccount_AccountCodeAlternateKey] ON [dbo].[DimAccount]([AccountCodeAlternateKey]) ON [PRIMARY];
12|2010-01-15 11:01:02.223|dbo|Event|Schema|DimProductSubcategory|CREATE TABLE [dbo].[DimProductSubcategory] ([ProductSubcategoryKey] [int] IDENTITY(1, 1) NOT NULL,[ProductSubcategoryAlternateKey] [int] NULL,[EnglishProductSubcategoryName] [nvarchar] (50) NOT NULL,[SpanishProductSubcategoryName] [nvarchar] (50) NOT NULL,[FrenchProductSubcategoryName] [nvarchar] (50) NOT NULL,[ProductCategoryKey] [int] NULL ) ON [PRIMARY];
87|2010-01-15 11:01:10.847|dbo|Event|Schema|IX_ProspectiveBuyer_ProspectAlternateKey|CREATE INDEX [IX_ProspectiveBuyer_ProspectAlternateKey] ON [dbo].[ProspectiveBuyer]([ProspectAlternateKey]) ON [PRIMARY];
71|2010-01-15 11:01:09.480|dbo|Event|Schema|IX_FactInternetSales_ProductKey|CREATE INDEX [IX_FactInternetSales_ProductKey] ON [dbo].[FactInternetSales]([ProductKey]) ON [PRIMARY];
48|2010-01-15 11:01:08.807|dbo|Event|Schema|FactSalesQuota|ALTER TABLE [dbo].[FactSalesQuota] ADDCONSTRAINT [PK_FactSalesQuota_SalesQuotaKey] PRIMARY KEY CLUSTERED([SalesQuotaKey]) ON [PRIMARY];
66|2010-01-15 11:01:08.963|dbo|Event|Schema|FactCallCenter|ALTER TABLE [dbo].[FactCallCenter] ADDCONSTRAINT [AK_FactCallCenter_DateKey_Shift] UNIQUE NONCLUSTERED([DateKey],[Shift])  ON [PRIMARY];
6|2010-01-15 11:01:02.207|dbo|Event|Schema|DimDepartmentGroup|CREATE TABLE [dbo].[DimDepartmentGroup] ([DepartmentGroupKey] [int] IDENTITY(1, 1) NOT NULL,[ParentDepartmentGroupKey] [int] NULL,[DepartmentGroupName] [nvarchar] (50) NULL ) ON [PRIMARY];
70|2010-01-15 11:01:09.370|dbo|Event|Schema|IX_FactInternetSales_OrderDateKey|CREATE INDEX [IX_FactInternetSales_OrderDateKey] ON [dbo].[FactInternetSales]([OrderDateKey]) ON [PRIMARY];
90|2010-01-15 11:01:10.877|dbo|Event|Schema|DimDepartmentGroup|ALTER TABLE [dbo].[DimDepartmentGroup] ADD CONSTRAINT [FK_DimDepartmentGroup_DimDepartmentGroup] FOREIGN KEY ([ParentDepartmentGroupKey]) REFERENCES [dbo].[DimDepartmentGroup] ([DepartmentGroupKey]);
4|2010-01-15 11:01:02.190|dbo|Event|Schema|DimCustomer|CREATE TABLE [dbo].[DimCustomer] ([CustomerKey] [int] IDENTITY(1, 1) NOT NULL,[GeographyKey] [int] NULL,[CustomerAlternateKey] [nvarchar] (15) NOT NULL,[Title] [nvarchar] (8) NULL,[FirstName] [nvarchar] (50) NULL,[MiddleName] [nvarchar] (50) NULL,[LastName] [nvarchar] (50) NULL,[NameStyle] [bit] NULL,[BirthDate] [date] NULL,[MaritalStatus] [nchar] (1) NULL,[Suffix] [nvarchar] (10) NULL,[Gender] [nvarchar] (1) NULL,[EmailAddress] [nvarchar] (50) NULL,[YearlyIncome] [money] NULL,[TotalChildren] [tinyint] NULL,[NumberChildrenAtHome] [tinyint] NULL,[EnglishEducation] [nvarchar] (40) NULL,[SpanishEducation] [nvarchar] (40) NULL,[FrenchEducation] [nvarchar] (40) NULL,[EnglishOccupation] [nvarchar] (100) NULL,[SpanishOccupation] [nvarchar] (100) NULL,[FrenchOccupation] [nvarchar] (100) NULL,[HouseOwnerFlag] [nchar] (1) NULL,[NumberCarsOwned] [tinyint] NULL,[AddressLine1] [nvarchar] (120) NULL,[AddressLine2] [nvarchar] (120) NULL,[Phone] [nvarchar] (20) NULL,[DateFirstPurchase] [date] NULL,[CommuteDistance] [nvarchar] (15) NULL) ON [PRIMARY];
18|2010-01-15 11:01:02.240|dbo|Event|Schema|FactCallCenter|CREATE TABLE [dbo].[FactCallCenter] ([FactCallCenterID] [int] IDENTITY(1,1) NOT NULL,[DateKey] [int] NOT NULL,[WageType] [nvarchar](15) NOT NULL,[Shift] [nvarchar](20) NOT NULL,[LevelOneOperators] [smallint] NOT NULL,[LevelTwoOperators] [smallint] NOT NULL,[TotalOperators] [smallint] NOT NULL,[Calls] [int] NOT NULL,[AutomaticResponses] [int] NOT NULL,[Orders] [int] NOT NULL,[IssuesRaised] [smallint] NOT NULL,[AverageTimePerIssue] [smallint] NOT NULL,[ServiceGrade] [float] NOT NULL) ON [PRIMARY];
111|2010-01-15 11:01:12.120|dbo|Event|Schema|vAssocSeqOrders|CREATE VIEW [dbo].[vAssocSeqOrders]ASSELECT DISTINCT[OrderNumber],[CustomerKey],[Region],[IncomeGroup]FROM[dbo].[vDMPrep] WHERE[FiscalYear] = '2004'
35|2010-01-15 11:01:08.120|dbo|Event|Schema|DimProductCategory|ALTER TABLE [dbo].[DimProductCategory] WITH CHECK ADD CONSTRAINT [PK_DimProductCategory_ProductCategoryKey] PRIMARY KEY CLUSTERED ([ProductCategoryKey])  ON [PRIMARY];
25|2010-01-15 11:01:02.597|dbo|Event|Schema|FactSurveyResponse|CREATE TABLE [dbo].[FactSurveyResponse] ([SurveyResponseKey] [int] IDENTITY(1, 1) NOT NULL,[DateKey] [int] NOT NULL,[CustomerKey] [int] NOT NULL,[ProductCategoryKey] [int] NOT NULL,[EnglishProductCategoryName] [nvarchar] (50) NOT NULL,[ProductSubcategoryKey] [int] NOT NULL,[EnglishProductSubcategoryName] [nvarchar] (50) NOT NULL,) ON [PRIMARY];
56|2010-01-15 11:01:08.917|dbo|Event|Schema|IX_DimEmployee_SalesTerritoryKey|CREATE INDEX [IX_DimEmployee_SalesTerritoryKey] ON [dbo].[DimEmployee]([SalesTerritoryKey]) ON [PRIMARY];
43|2010-01-15 11:01:08.167|dbo|Event|Schema|FactCallCenter|ALTER TABLE [dbo].[FactCallCenter] WITH CHECK ADDCONSTRAINT [PK_FactCallCenter_FactCallCenterID] PRIMARY KEY CLUSTERED([FactCallCenterID]) ON [PRIMARY];
42|2010-01-15 11:01:08.167|dbo|Event|Schema|DimDate|ALTER TABLE [dbo].[DimDate] WITH CHECK ADD CONSTRAINT [PK_DimDate_DateKey] PRIMARY KEY CLUSTERED ([DateKey])  ON [PRIMARY];
45|2010-01-15 11:01:08.463|dbo|Event|Schema|FactInternetSales|ALTER TABLE [dbo].[FactInternetSales] ADD CONSTRAINT [PK_FactInternetSales_SalesOrderNumber_SalesOrderLineNumber] PRIMARY KEY CLUSTERED ([SalesOrderNumber],[SalesOrderLineNumber])  ON [PRIMARY];
77|2010-01-15 11:01:10.223|dbo|Event|Schema|IX_FactResellerSales_ProductKey|CREATE INDEX [IX_FactResellerSales_ProductKey] ON [dbo].[FactResellerSales]([ProductKey]) ON [PRIMARY];
76|2010-01-15 11:01:10.113|dbo|Event|Schema|IX_FactResellerSales_OrderDateKey|CREATE INDEX [IX_FactResellerSales_OrderDateKey] ON [dbo].[FactResellerSales]([OrderDateKey]) ON [PRIMARY];
38|2010-01-15 11:01:08.137|dbo|Event|Schema|DimReseller|ALTER TABLE [dbo].[DimReseller] WITH CHECK ADD CONSTRAINT [PK_DimReseller_ResellerKey] PRIMARY KEY CLUSTERED ([ResellerKey])  ON [PRIMARY];
96|2010-01-15 11:01:10.910|dbo|Event|Schema|DimReseller|ALTER TABLE [dbo].[DimReseller] ADD CONSTRAINT [FK_DimReseller_DimGeography] FOREIGN KEY ([GeographyKey]) REFERENCES [dbo].[DimGeography] ([GeographyKey]);
30|2010-01-15 11:01:08.027|dbo|Event|Schema|DimDepartmentGroup|ALTER TABLE [dbo].[DimDepartmentGroup] WITH CHECK ADD CONSTRAINT [PK_DimDepartmentGroup] PRIMARY KEY CLUSTERED ([DepartmentGroupKey])  ON [PRIMARY];
103|2010-01-15 11:01:11.897|dbo|Event|Schema|FactSalesQuota|ALTER TABLE [dbo].[FactSalesQuota] ADD CONSTRAINT [FK_FactSalesQuota_DimEmployee] FOREIGN KEY ([EmployeeKey]) REFERENCES [dbo].[DimEmployee] ([EmployeeKey]),CONSTRAINT [FK_FactSalesQuota_DimDate] FOREIGN KEY ([DateKey]) REFERENCES [dbo].[DimDate] ([DateKey]);
26|2010-01-15 11:01:02.597|dbo|Event|Schema|ProspectiveBuyer|CREATE TABLE [dbo].[ProspectiveBuyer] ([ProspectiveBuyerKey] [int] IDENTITY(1, 1) NOT NULL,[ProspectAlternateKey] [nvarchar] (15) NULL,[FirstName] [nvarchar] (50) NULL,[MiddleName] [nvarchar] (50) NULL,[LastName] [nvarchar] (50) NULL,[BirthDate] [datetime] NULL,[MaritalStatus] [nchar] (1) NULL,[Gender] [nvarchar] (1) NULL,[EmailAddress] [nvarchar] (50) NULL,[YearlyIncome] [money] NULL,[TotalChildren] [tinyint] NULL,[NumberChildrenAtHome] [tinyint] NULL,[Education] [nvarchar] (40) NULL,[Occupation] [nvarchar] (100) NULL,[HouseOwnerFlag] [nchar] (1) NULL,[NumberCarsOwned] [tinyint] NULL,[AddressLine1] [nvarchar] (120) NULL,[AddressLine2] [nvarchar] (120) NULL,[City] [nvarchar](30) NULL, [StateProvinceCode] [nvarchar] (3) NULL,[PostalCode] [nvarchar](15) NULL, [Phone] [nvarchar] (20) NULL, [Salutation] [nvarchar] (8) NULL, [Unknown] [int] NULL ) ON [PRIMARY];
65|2010-01-15 11:01:08.963|dbo|Event|Schema|DimDate|ALTER TABLE [dbo].[DimDate] ADD CONSTRAINT [AK_DimDate_FullDateAlternateKey] UNIQUE NONCLUSTERED ([FullDateAlternateKey])  ON [PRIMARY];
16|2010-01-15 11:01:02.240|dbo|Event|Schema|DimSalesTerritory|CREATE TABLE [dbo].[DimSalesTerritory] ([SalesTerritoryKey] [int] IDENTITY(1, 1) NOT NULL,[SalesTerritoryAlternateKey] [int] NULL,[SalesTerritoryRegion] [nvarchar] (50) NOT NULL,[SalesTerritoryCountry] [nvarchar] (50) NOT NULL,[SalesTerritoryGroup] [nvarchar] (50) NULL) ON [PRIMARY];
64|2010-01-15 11:01:08.963|dbo|Event|Schema|DimSalesTerritory|ALTER TABLE [dbo].[DimSalesTerritory] ADD CONSTRAINT [AK_DimSalesTerritory_SalesTerritoryAlternateKey] UNIQUE NONCLUSTERED ([SalesTerritoryAlternateKey])  ON [PRIMARY];
29|2010-01-15 11:01:08.020|dbo|Event|Schema|DimCustomer|ALTER TABLE [dbo].[DimCustomer] WITH CHECK ADD CONSTRAINT [PK_DimCustomer_CustomerKey] PRIMARY KEY CLUSTERED ([CustomerKey])  ON [PRIMARY];
93|2010-01-15 11:01:10.893|dbo|Event|Schema|DimOrganization|ALTER TABLE [dbo].[DimOrganization] ADD CONSTRAINT [FK_DimOrganization_DimOrganization] FOREIGN KEY ([ParentOrganizationKey]) REFERENCES [dbo].[DimOrganization] ([OrganizationKey]),CONSTRAINT [FK_DimOrganization_DimCurrency] FOREIGN KEY([CurrencyKey]) REFERENCES [dbo].[DimCurrency] ([CurrencyKey]);
104|2010-01-15 11:01:11.910|dbo|Event|Schema|FactSurveyResponse|ALTER TABLE [dbo].[FactSurveyResponse] ADDCONSTRAINT [FK_FactSurveyResponse_DateKey] FOREIGN KEY([DateKey]) REFERENCES [dbo].[DimDate] ([DateKey]),CONSTRAINT [FK_FactSurveyResponse_CustomerKey] FOREIGN KEY([CustomerKey]) REFERENCES [dbo].[DimCustomer] ([CustomerKey]);
94|2010-01-15 11:01:10.893|dbo|Event|Schema|DimProduct|ALTER TABLE [dbo].[DimProduct] ADD CONSTRAINT [FK_DimProduct_DimProductSubcategory] FOREIGN KEY ([ProductSubcategoryKey]) REFERENCES [dbo].[DimProductSubcategory] ([ProductSubcategoryKey]);
74|2010-01-15 11:01:09.900|dbo|Event|Schema|IX_FactResellerSales_CurrencyKey|CREATE INDEX [IX_FactResellerSales_CurrencyKey] ON [dbo].[FactResellerSales]([CurrencyKey]) ON [PRIMARY];
23|2010-01-15 11:01:02.253|dbo|Event|Schema|FactInternetSalesReason|CREATE TABLE [dbo].[FactInternetSalesReason] ([SalesOrderNumber] [nvarchar] (20) NOT NULL,[SalesOrderLineNumber] [tinyint] NOT NULL,[SalesReasonKey] [int] NOT NULL ) ON [PRIMARY];
98|2010-01-15 11:01:10.940|dbo|Event|Schema|FactCurrencyRate|ALTER TABLE [dbo].[FactCurrencyRate] ADD CONSTRAINT [FK_FactCurrencyRate_DimDate] FOREIGN KEY ([DateKey]) REFERENCES [dbo].[DimDate] ([DateKey]),CONSTRAINT [FK_FactCurrencyRate_DimCurrency] FOREIGN KEY ([CurrencyKey]) REFERENCES [dbo].[DimCurrency] ([CurrencyKey]);
105|2010-01-15 11:01:11.910|dbo|Event|Schema|udfMinimumDate|CREATE FUNCTION [dbo].[udfMinimumDate] (@x DATETIME, @y DATETIME) RETURNS DATETIMEASBEGINDECLARE @z DATETIMEIF @x <= @y SET @z = @x ELSE SET @z = @yRETURN(@z)END
62|2010-01-15 11:01:08.947|dbo|Event|Schema|DimReseller|ALTER TABLE [dbo].[DimReseller] ADD CONSTRAINT [AK_DimReseller_ResellerAlternateKey] UNIQUE NONCLUSTERED ([ResellerAlternateKey])  ON [PRIMARY];
73|2010-01-15 11:01:09.760|dbo|Event|Schema|IX_FactIneternetSales_ShipDateKey|CREATE INDEX [IX_FactIneternetSales_ShipDateKey] ON [dbo].[FactInternetSales]([ShipDateKey]) ON [PRIMARY];
37|2010-01-15 11:01:08.137|dbo|Event|Schema|DimPromotion|ALTER TABLE [dbo].[DimPromotion] WITH CHECK ADD CONSTRAINT [PK_DimPromotion_PromotionKey] PRIMARY KEY CLUSTERED ([PromotionKey])  ON [PRIMARY];
40|2010-01-15 11:01:08.150|dbo|Event|Schema|DimSalesTerritory|ALTER TABLE [dbo].[DimSalesTerritory] WITH CHECK ADD CONSTRAINT [PK_DimSalesTerritory_SalesTerritoryKey] PRIMARY KEY CLUSTERED ([SalesTerritoryKey])  ON [PRIMARY];
72|2010-01-15 11:01:09.667|dbo|Event|Schema|IX_FactInternetSales_PromotionKey|CREATE INDEX [IX_FactInternetSales_PromotionKey] ON [dbo].[FactInternetSales]([PromotionKey]) ON [PRIMARY];
91|2010-01-15 11:01:10.877|dbo|Event|Schema|DimEmployee|ALTER TABLE [dbo].[DimEmployee] ADD CONSTRAINT [FK_DimEmployee_DimEmployee] FOREIGN KEY ([ParentEmployeeKey]) REFERENCES [dbo].[DimEmployee] ([EmployeeKey]),CONSTRAINT [FK_DimEmployee_DimSalesTerritory] FOREIGN KEY ([SalesTerritoryKey]) REFERENCES [dbo].[DimSalesTerritory] ([SalesTerritoryKey]);
100|2010-01-15 11:01:11.460|dbo|Event|Schema|FactInternetSalesReason|ALTER TABLE [dbo].[FactInternetSalesReason] ADD CONSTRAINT [FK_FactInternetSalesReason_DimSalesReason] FOREIGN KEY ([SalesReasonKey]) REFERENCES [dbo].[DimSalesReason] ([SalesReasonKey]),CONSTRAINT [FK_FactInternetSalesReason_FactInternetSales] FOREIGN KEY ([SalesOrderNumber],[SalesOrderLineNumber]) REFERENCES [dbo].[FactInternetSales] ([SalesOrderNumber],[SalesOrderLineNumber]);
49|2010-01-15 11:01:08.820|dbo|Event|Schema|FactSurveyResponse|ALTER TABLE [dbo].[FactSurveyResponse] ADDCONSTRAINT [PK_FactSurveyResponse_SurveyResponseKey] PRIMARY KEY CLUSTERED([SurveyResponseKey]) ON [PRIMARY];
11|2010-01-15 11:01:02.223|dbo|Event|Schema|DimProductCategory|CREATE TABLE [dbo].[DimProductCategory] ([ProductCategoryKey] [int] IDENTITY(1, 1) NOT NULL,[ProductCategoryAlternateKey] [int] NULL,[EnglishProductCategoryName] [nvarchar] (50) NOT NULL, [SpanishProductCategoryName] [nvarchar] (50) NOT NULL,[FrenchProductCategoryName] [nvarchar] (50) NOT NULL) ON [PRIMARY];
27|2010-01-15 11:01:07.940|dbo|Event|Schema|DimAccount|ALTER TABLE [dbo].[DimAccount] WITH CHECK ADD CONSTRAINT [PK_DimAccount] PRIMARY KEY CLUSTERED ([AccountKey])  ON [PRIMARY];
57|2010-01-15 11:01:08.930|dbo|Event|Schema|DimProduct|ALTER TABLE [dbo].[DimProduct] ADD CONSTRAINT [AK_DimProduct_ProductAlternateKey_StartDate] UNIQUE NONCLUSTERED ([ProductAlternateKey],[StartDate])  ON [PRIMARY];
47|2010-01-15 11:01:08.807|dbo|Event|Schema|FactInternetSalesReason|ALTER TABLE [dbo].[FactInternetSalesReason] ADD CONSTRAINT [PK_FactInternetSalesReason_SalesOrderNumber_SalesOrderLineNumber_SalesReasonKey] PRIMARY KEY CLUSTERED ([SalesOrderNumber],[SalesOrderLineNumber],[SalesReasonKey])  ON [PRIMARY];
102|2010-01-15 11:01:11.880|dbo|Event|Schema|FactResellerSales|ALTER TABLE [dbo].[FactResellerSales] ADD CONSTRAINT [FK_FactResellerSales_DimCurrency] FOREIGN KEY ([CurrencyKey]) REFERENCES [dbo].[DimCurrency] ([CurrencyKey]),CONSTRAINT [FK_FactResellerSales_DimProduct] FOREIGN KEY ([ProductKey]) REFERENCES [dbo].[DimProduct] ([ProductKey]),CONSTRAINT [FK_FactResellerSales_DimPromotion] FOREIGN KEY ([PromotionKey]) REFERENCES [dbo].[DimPromotion] ([PromotionKey]),CONSTRAINT [FK_FactResellerSales_DimDate] FOREIGN KEY ([OrderDateKey]) REFERENCES [dbo].[DimDate] ([DateKey]),CONSTRAINT [FK_FactResellerSales_DimDate1] FOREIGN KEY ([DueDateKey]) REFERENCES [dbo].[DimDate] ([DateKey]),CONSTRAINT [FK_FactResellerSales_DimDate2] FOREIGN KEY ([ShipDateKey]) REFERENCES [dbo].[DimDate] ([DateKey]),CONSTRAINT [FK_FactResellerSales_DimEmployee] FOREIGN KEY ([EmployeeKey]) REFERENCES [dbo].[DimEmployee] ([EmployeeKey]),CONSTRAINT [FK_FactResellerSales_DimReseller] FOREIGN KEY ([ResellerKey]) REFERENCES [dbo].[DimReseller] ([ResellerKey]),CONSTRAINT [FK_FactResellerSales_DimSalesTerritory] FOREIGN KEY ([SalesTerritoryKey]) REFERENCES [dbo].[DimSalesTerritory] ([SalesTerritoryKey]);
34|2010-01-15 11:01:08.120|dbo|Event|Schema|DimProduct|ALTER TABLE [dbo].[DimProduct] WITH CHECK ADD CONSTRAINT [PK_DimProduct_ProductKey] PRIMARY KEY CLUSTERED ([ProductKey])  ON [PRIMARY];
107|2010-01-15 11:01:11.943|dbo|Event|Schema|udfBuildISO8601Date|CREATE FUNCTION [dbo].[udfBuildISO8601Date] (@year int, @month int, @day int)RETURNS datetimeAS BEGINRETURN cast(convert(varchar, @year) + '-' + [dbo].[udfTwoDigitZeroFill](@month) + '-' + [dbo].[udfTwoDigitZeroFill](@day) + 'T00:00:00' as datetime);END
53|2010-01-15 11:01:08.883|dbo|Event|Schema|DimCustomer|ALTER TABLE [dbo].[DimCustomer] ADD CONSTRAINT [IX_DimCustomer_CustomerAlternateKey] UNIQUE NONCLUSTERED ([CustomerAlternateKey])  ON [PRIMARY];
33|2010-01-15 11:01:08.090|dbo|Event|Schema|DimOrganization|ALTER TABLE [dbo].[DimOrganization] WITH CHECK ADD CONSTRAINT [PK_DimOrganization] PRIMARY KEY CLUSTERED ([OrganizationKey])  ON [PRIMARY];
101|2010-01-15 11:01:11.663|dbo|Event|Schema|FactInternetSales|ALTER TABLE [dbo].[FactInternetSales] ADD CONSTRAINT [FK_FactInternetSales_DimCurrency] FOREIGN KEY ([CurrencyKey]) REFERENCES [dbo].[DimCurrency] ([CurrencyKey]),CONSTRAINT [FK_FactInternetSales_DimCustomer] FOREIGN KEY ([CustomerKey]) REFERENCES [dbo].[DimCustomer] ([CustomerKey]),CONSTRAINT [FK_FactInternetSales_DimProduct] FOREIGN KEY ([ProductKey]) REFERENCES [dbo].[DimProduct] ([ProductKey]),CONSTRAINT [FK_FactInternetSales_DimPromotion] FOREIGN KEY ([PromotionKey]) REFERENCES [dbo].[DimPromotion] ([PromotionKey]),CONSTRAINT [FK_FactInternetSales_DimDate] FOREIGN KEY ([OrderDateKey]) REFERENCES [dbo].[DimDate] ([DateKey]),CONSTRAINT [FK_FactInternetSales_DimDate1] FOREIGN KEY ([DueDateKey]) REFERENCES [dbo].[DimDate] ([DateKey]),CONSTRAINT [FK_FactInternetSales_DimDate2] FOREIGN KEY ([ShipDateKey]) REFERENCES [dbo].[DimDate] ([DateKey]),CONSTRAINT [FK_FactInternetSales_DimSalesTerritory] FOREIGN KEY ([SalesTerritoryKey]) REFERENCES [dbo].[DimSalesTerritory] ([SalesTerritoryKey]);
80|2010-01-15 11:01:10.690|dbo|Event|Schema|IX_FactResellerSales_EmployeeKey|CREATE INDEX [IX_FactResellerSales_EmployeeKey] ON [dbo].[FactResellerSales]([EmployeeKey]) ON [PRIMARY];
112|2010-01-15 11:01:12.120|dbo|Event|Schema|vAssocSeqLineItems|CREATE VIEW [dbo].[vAssocSeqLineItems] ASSELECTOrderNumber,LineNumber,ModelFROM[dbo].[vDMPrep] WHEREFiscalYear = '2004';
21|2010-01-15 11:01:02.240|dbo|Event|Schema|FactInternetSales|CREATE TABLE [dbo].[FactInternetSales] ([ProductKey] [int] NOT NULL,[OrderDateKey] [int] NOT NULL,[DueDateKey] [int] NOT NULL,[ShipDateKey] [int] NOT NULL,[CustomerKey] [int] NOT NULL,[PromotionKey] [int] NOT NULL,[CurrencyKey] [int] NOT NULL,[SalesTerritoryKey] [int] NOT NULL,[SalesOrderNumber] [nvarchar] (20) NOT NULL,[SalesOrderLineNumber] [tinyint] NOT NULL,[RevisionNumber] [tinyint] NOT NULL,[OrderQuantity] [smallint] NOT NULL,[UnitPrice] [money] NOT NULL,[ExtendedAmount] [money] NOT NULL,[UnitPriceDiscountPct] [float] NOT NULL,[DiscountAmount] [float] NOT NULL,[ProductStandardCost] [money] NOT NULL,[TotalProductCost] [money] NOT NULL,[SalesAmount] [money] NOT NULL,[TaxAmt] [money] NOT NULL,[Freight] [money] NOT NULL,[CarrierTrackingNumber] [nvarchar] (25) NULL,[CustomerPONumber] [nvarchar] (25) NULL ) ON [PRIMARY];
36|2010-01-15 11:01:08.120|dbo|Event|Schema|DimProductSubcategory|ALTER TABLE [dbo].[DimProductSubcategory] WITH CHECK ADD CONSTRAINT [PK_DimProductSubcategory_ProductSubcategoryKey] PRIMARY KEY CLUSTERED ([ProductSubcategoryKey])  ON [PRIMARY];
68|2010-01-15 11:01:09.180|dbo|Event|Schema|IX_FactInternetSales_CustomerKey|CREATE INDEX [IX_FactInternetSales_CustomerKey] ON [dbo].[FactInternetSales]([CustomerKey]) ON [PRIMARY];
22|2010-01-15 11:01:02.240|dbo|Event|Schema|FactResellerSales|CREATE TABLE [dbo].[FactResellerSales] ([ProductKey] [int] NOT NULL,[OrderDateKey] [int] NOT NULL,[DueDateKey] [int] NOT NULL,[ShipDateKey] [int] NOT NULL,[ResellerKey] [int] NOT NULL,[EmployeeKey] [int] NOT NULL,[PromotionKey] [int] NOT NULL,[CurrencyKey] [int] NOT NULL,[SalesTerritoryKey] [int] NOT NULL,[SalesOrderNumber] [nvarchar] (20) NOT NULL,[SalesOrderLineNumber] [tinyint] NOT NULL,[RevisionNumber] [tinyint] NULL,[OrderQuantity] [smallint] NULL,[UnitPrice] [money] NULL,[ExtendedAmount] [money] NULL,[UnitPriceDiscountPct] [float] NULL,[DiscountAmount] [float] NULL,[ProductStandardCost] [money] NULL,[TotalProductCost] [money] NULL,[SalesAmount] [money] NULL,[TaxAmt] [money] NULL,[Freight] [money] NULL,[CarrierTrackingNumber] [nvarchar] (25) NULL,[CustomerPONumber] [nvarchar] (25) NULL ) ON [PRIMARY];
95|2010-01-15 11:01:10.893|dbo|Event|Schema|DimProductSubcategory|ALTER TABLE [dbo].[DimProductSubcategory] ADD CONSTRAINT [FK_DimProductSubcategory_DimProductCategory] FOREIGN KEY ([ProductCategoryKey]) REFERENCES [dbo].[DimProductCategory] ([ProductCategoryKey]);
92|2010-01-15 11:01:10.877|dbo|Event|Schema|DimGeography|ALTER TABLE [dbo].[DimGeography] ADD CONSTRAINT [FK_DimGeography_DimSalesTerritory] FOREIGN KEY ([SalesTerritoryKey]) REFERENCES [dbo].[DimSalesTerritory] ([SalesTerritoryKey]);
89|2010-01-15 11:01:10.860|dbo|Event|Schema|DimCustomer|ALTER TABLE [dbo].[DimCustomer] ADD CONSTRAINT [FK_DimCustomer_DimGeography] FOREIGN KEY ([GeographyKey]) REFERENCES [dbo].[DimGeography] ([GeographyKey]);
67|2010-01-15 11:01:09.090|dbo|Event|Schema|IX_FactInternetSales_CurrencyKey|CREATE INDEX [IX_FactInternetSales_CurrencyKey] ON [dbo].[FactInternetSales]([CurrencyKey]) ON [PRIMARY];
109|2010-01-15 11:01:11.943|dbo|Event|Schema|vTimeSeries|CREATE VIEW [dbo].[vTimeSeries] ASSELECT CASE [Model] WHEN 'Mountain-100' THEN 'M200' WHEN 'Road-150' THEN 'R250' WHEN 'Road-650' THEN 'R750' WHEN 'Touring-1000' THEN 'T1000' ELSE Left([Model], 1) + Right([Model], 3) END + ' ' + [Region] AS [ModelRegion] ,(Convert(Integer, [CalendarYear]) * 100) + Convert(Integer, [Month]) AS [TimeIndex] ,Sum([Quantity]) AS [Quantity] ,Sum([Amount]) AS [Amount],CalendarYear,[Month],[dbo].[udfBuildISO8601Date] ([CalendarYear], [Month], 25)as ReportingDateFROM [dbo].[vDMPrep] WHERE [Model] IN ('Mountain-100', 'Mountain-200', 'Road-150', 'Road-250', 'Road-650', 'Road-750', 'Touring-1000') GROUP BY CASE [Model] WHEN 'Mountain-100' THEN 'M200' WHEN 'Road-150' THEN 'R250' WHEN 'Road-650' THEN 'R750' WHEN 'Touring-1000' THEN 'T1000' ELSE Left(Model,1) + Right(Model,3) END + ' ' + [Region] ,(Convert(Integer, [CalendarYear]) * 100) + Convert(Integer, [Month]),CalendarYear,[Month],[dbo].[udfBuildISO8601Date] ([CalendarYear], [Month], 25);
108|2010-01-15 11:01:11.943|dbo|Event|Schema|vDMPrep|CREATE VIEW [dbo].[vDMPrep]ASSELECTpc.[EnglishProductCategoryName],Coalesce(p.[ModelName], p.[EnglishProductName]) AS [Model],c.[CustomerKey],s.[SalesTerritoryGroup] AS [Region],CASEWHEN Month(GetDate()) < Month(c.[BirthDate])THEN DateDiff(yy,c.[BirthDate],GetDate()) - 1WHEN Month(GetDate()) = Month(c.[BirthDate])AND Day(GetDate()) < Day(c.[BirthDate])THEN DateDiff(yy,c.[BirthDate],GetDate()) - 1ELSE DateDiff(yy,c.[BirthDate],GetDate())END AS [Age],CASEWHEN c.[YearlyIncome] < 40000 THEN 'Low'WHEN c.[YearlyIncome] > 60000 THEN 'High'ELSE 'Moderate'END AS [IncomeGroup],d.[CalendarYear],d.[FiscalYear],d.[MonthNumberOfYear] AS [Month],f.[SalesOrderNumber] AS [OrderNumber],f.SalesOrderLineNumber AS LineNumber,f.OrderQuantity AS Quantity,f.ExtendedAmount AS Amount  FROM[dbo].[FactInternetSales] fINNER JOIN [dbo].[DimDate] dON f.[OrderDateKey] = d.[DateKey]INNER JOIN [dbo].[DimProduct] pON f.[ProductKey] = p.[ProductKey]INNER JOIN [dbo].[DimProductSubcategory] pscON p.[ProductSubcategoryKey] = psc.[ProductSubcategoryKey]INNER JOIN [dbo].[DimProductCategory] pcON psc.[ProductCategoryKey] = pc.[ProductCategoryKey]INNER JOIN [dbo].[DimCustomer] cON f.[CustomerKey] = c.[CustomerKey]INNER JOIN [dbo].[DimGeography] gON c.[GeographyKey] = g.[GeographyKey]INNER JOIN [dbo].[DimSalesTerritory] sON g.[SalesTerritoryKey] = s.[SalesTerritoryKey] ;
99|2010-01-15 11:01:11.130|dbo|Event|Schema|FactFinance|ALTER TABLE [dbo].[FactFinance] ADD CONSTRAINT [FK_FactFinance_DimAccount] FOREIGN KEY ([AccountKey]) REFERENCES [dbo].[DimAccount] ([AccountKey]),CONSTRAINT [FK_FactFinance_DimDepartmentGroup] FOREIGN KEY ([DepartmentGroupKey]) REFERENCES [dbo].[DimDepartmentGroup] ([DepartmentGroupKey]),CONSTRAINT [FK_FactFinance_DimOrganization] FOREIGN KEY ([OrganizationKey]) REFERENCES [dbo].[DimOrganization] ([OrganizationKey]),CONSTRAINT [FK_FactFinance_DimScenario] FOREIGN KEY ([ScenarioKey]) REFERENCES [dbo].[DimScenario] ([ScenarioKey]),CONSTRAINT [FK_FactFinance_DimDate] FOREIGN KEY ([DateKey]) REFERENCES [dbo].[DimDate] ([DateKey]);
19|2010-01-15 11:01:02.240|dbo|Event|Schema|FactCurrencyRate|CREATE TABLE [dbo].[FactCurrencyRate] ([CurrencyKey] [int] NOT NULL,[DateKey] [int] NOT NULL,[AverageRate] [float] NOT NULL,[EndOfDayRate] [float] NOT NULL ) ON [PRIMARY];
